schemaVersion: 1.0
metadata:
  name: inventory-management-backend
  description: Flask backend for inventory management system
buildSpec:
  source:
    context: .
    docker:
      file: Dockerfile
  env:
    - name: FLASK_ENV
      value: production
    - name: DB_HOST
      value: ${DB_HOST}
    - name: DB_PORT
      value: ${DB_PORT}
    - name: DB_USER
      value: ${DB_USER}
    - name: DB_NAME
      value: ${DB_NAME}
    - name: DB_PWD
      value: ${DB_PWD}
    - name: SECRET_KEY
      value: ${SECRET_KEY}
    - name: JWT_SECRET_KEY
      value: ${JWT_SECRET_KEY}
deploy:
  resources:
    cpu: 0.5
    memory: 512Mi
  restartPolicy: Always
expose:
  api:
    context: /api
    port: 8080
    basePath: /api
    definitions:
      - path: /test
        method: GET
      - path: /debug/db-test
        method: GET
      - path: /debug/orders-test
        method: GET
      - path: /orders
        method: GET
      - path: /inventory
        method: GET
      - path: /inventory
        method: POST
      - path: /inventory/{item_id}
        method: PUT
      - path: /inventory/{item_id}
        method: DELETE
      - path: /warehouses
        method: GET
      - path: /warehouses
        method: POST
      - path: /warehouses
        method: OPTIONS
      - path: /warehouses/{warehouse_id}
        method: PUT
      - path: /warehouses/{warehouse_id}
        method: DELETE
      - path: /warehouses/{warehouse_id}
        method: OPTIONS
      - path: /alerts
        method: GET
      - path: /alerts/{alert_id}/resolve
        method: PUT
      - path: /locations
        method: GET
      - path: /customers
        method: GET
      - path: /customers
        method: POST
      - path: /suppliers
        method: GET
      - path: /suppliers
        method: POST
      - path: /suppliers
        method: OPTIONS
